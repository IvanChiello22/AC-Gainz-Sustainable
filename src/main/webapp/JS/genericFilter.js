let currentPage=1;function genericFilter(){console.log("Calling genericFilter");let e=document.getElementById("tastes").value,t=document.getElementById("sorting").value,n=document.getElementById("weights").value,a=new URLSearchParams;e&&a.append("taste",e),t&&a.append("sorting",t),n&&a.append("weight",n);fetch(`genericFilter?${a.toString()}`).then(e=>{if(!e.ok)throw Error();return e.text()}).then(e=>{updateView(e)}).catch(e=>{console.log(e)})}function updateView(e){let t=document.querySelector("#gr");t.innerHTML="";let n;try{n=JSON.parse(e)}catch(a){console.error("Error parsing JSON response:",a);return}if(Array.isArray(n)||(n=n.products||[]),!n||0===n.length){t.innerHTML='<div class="no-products-message" style="text-align: center; padding: 40px; width: 100%;"><h3>Nessun prodotto trovato</h3><p>Prova a modificare i filtri di ricerca</p></div>',hidePagination();return}n.forEach(e=>{let n=document.createElement("div");n.className="product-card";let a=document.createElement("div");if(a.className="product-image",e.sconto>0){let i=document.createElement("span");i.className="product-sconto",i.innerText=`${e.sconto}% di Sconto`,a.appendChild(i)}let r=document.createElement("form");r.action="ProductInfo",r.method="POST",r.id=`${e.id}`;let l=document.createElement("input");l.type="hidden",l.name="primaryKey",l.value=`${e.id}`,r.appendChild(l),a.appendChild(r);let o=document.createElement("img");o.src=e.immagine,o.alt=e.nome,o.onclick=function(){r.submit()},a.appendChild(o),n.appendChild(a);let c=document.createElement("div");c.className="product-info";let d=document.createElement("h2");if(d.className="product-info-name",d.innerText=`${e.nome}`,c.appendChild(d),e.sconto>0){let p=document.createElement("span");p.className="product-info-price-off";let s=e.prezzo*(1-e.sconto/100);p.innerText=`${s.toFixed(2)}€`,c.appendChild(p);let m=document.createElement("span");m.className="product-info-price",m.innerText=`${e.prezzo.toFixed(2)}€`,c.appendChild(m)}else{let u=document.createElement("span");u.className="product-info-price-off",u.innerText=`${e.prezzo.toFixed(2)}€`,c.appendChild(u)}let g=document.createElement("span");g.className="product-info-flavour",g.innerText=e.gusto,c.appendChild(g),n.appendChild(c);let h=document.createElement("button");h.innerHTML="Aggiungi al carrello",h.className="cartAdd",h.onclick=function(){optionsVarianti(`${e.idVariante}`)},n.appendChild(h),t.appendChild(n)}),hidePagination()}function hidePagination(){let e=document.getElementById("pagination-container");e&&(e.innerHTML="")}function resetProducts(){document.querySelectorAll("select").forEach(e=>{e.value=""});let e=document.getElementById("currentCategory"),t=e?e.value:"tutto";window.location.href=`categories?category=${encodeURIComponent(t)}`}