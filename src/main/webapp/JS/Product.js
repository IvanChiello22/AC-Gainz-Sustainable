function updatePriceProduct(e,t,o){let r=new URLSearchParams;r.append("idProdotto",e),r.append("flavour",t),r.append("weight",o),r.append("action","updatePrice"),fetch("showOptions?"+r.toString()).then(e=>{if(!e.ok)throw Error(`Network Error: ${e.status} - ${e.statusText}`);return e.text()}).then(e=>{updatePriceProductView(e)}).catch(e=>{console.error(e)})}function updatePriceProductView(e){let t=JSON.parse(e),o=document.querySelector(".product-info");if(o){if(t.sconto>0){let r=o.querySelector(".product-info-risparmio");r||((r=document.createElement("div")).className="product-info-risparmio"),r.innerText=`Risparmia ${(t.prezzo*t.sconto/100).toFixed(2)} €`;let n=o.querySelector(".product-info-costoattuale");n||((n=document.createElement("span")).className="product-info-costoattuale"),n.innerText=`${(t.prezzo*(1-t.sconto/100)).toFixed(2)}€`;let i=o.querySelector(".product-info-costooriginale");i||((i=document.createElement("span")).className="product-info-costooriginale",o.prepend(r,n,i)),i.innerText=` Era ${t.prezzo} €`}else{let a=o.querySelector(".product-info-costoattuale");a||((a=document.createElement("span")).className="product-info-costoattuale",o.prepend(a)),a.innerText=`${(t.prezzo*(1-t.sconto/100)).toFixed(2)} €`;let c=o.querySelector(".product-info-risparmio"),u=o.querySelector(".product-info-costooriginale");c&&c.remove(),u&&u.remove()}}}function updateOptionsProduct(e,t){let o=new URLSearchParams;return o.append("action","updateOptions"),o.append("flavour",t),o.append("idProdotto",e),fetch("showOptions?"+o.toString()).then(e=>{if(!e.ok)throw Error(`Network error: ${e.status} - ${e.statusText}`);return e.text()}).then(e=>{updateWeightOptionsProduct(e)})}function updateWeightOptionsProduct(e){let t=JSON.parse(e),o=document.querySelector(".product-info-peso").querySelector("#weights");o.innerHTML="",t.forEach(e=>{let t=document.createElement("option");t.innerText=`${e.peso}`,o.appendChild(t)})}document.addEventListener("DOMContentLoaded",function(){let e=document.getElementById("tastes"),t=document.getElementById("weights"),o=e.getAttribute("data-product-id");e.onchange=function(){updateOptionsProduct(o,this.value).then(()=>{updatePriceProduct(o,e.value,t.value)}).catch(e=>{console.error(e)})};document.querySelector(".cartAddProduct").onclick=function(){addCartVariant(o,document.getElementById("quantitynumber").value,e.value,t.value)},t.onchange=function(){updatePriceProduct(o,e.value,this.value)};let r=document.getElementsByClassName("product-description-accordion");for(let n=0;n<r.length;n++)r[n].addEventListener("click",function(){this.classList.toggle("active");let e=this.nextElementSibling;"block"===e.style.display?e.style.display="none":e.style.display="block"})});