function editTableRow(e,t){document.querySelector(".tableDB").style.display="none";let n=new URLSearchParams;n.append("tableName",e),n.append("primaryKey",t),fetch("showRowForm?"+n.toString()).then(e=>{if(!e.ok)throw Error("Network error");return e.json()}).then(n=>{showUpdateForm(n[0],e,t)}).catch(e=>{console.error(e)})}function showUpdateForm(e,t,n){let i=document.createElement("div");i.className="divForm";let a=document.createElement("button");a.innerText="Go Back",a.onclick=function(){window.location.href="showTable?tableName="+t},i.appendChild(a);let l=document.createElement("form");l.className="formUpdate",l.action="editRow",l.method="POST",l.enctype="multipart/form-data";let o=document.createElement("input");o.type="hidden",o.name="tableName",o.value=t,l.appendChild(o);let d=document.createElement("input");d.type="hidden",d.name="primaryKey",d.value=n,l.appendChild(d);let r=getFields(t);r.forEach(t=>{if("textarea"!==t.type&&"password"!==t.type){let n=document.createElement("label");n.htmlFor=t.id,n.innerText=t.label,l.appendChild(n);let i=document.createElement("input");"file"===t.type&&(i.type="text"),i.name=t.id,i.onfocus=function(){i.value=e[t.id]},l.appendChild(i)}});let c=document.createElement("button");c.innerText="Modifica",c.type="submit",l.append(c),i.append(l),document.body.append(i)}function deleteTableRow(e,t){let n=new URLSearchParams;n.append("tableName",e),n.append("primaryKey",t),confirm("Vuoi davvero eliminare questa riga?")&&fetch("deleteRow?"+n.toString()).then(e=>{if(e.redirected){console.log("response redirected"),window.location.href=e.url;return}if(!e.ok)throw Error(`Network error: ${e.status} - ${e.statusText}`);return e.json()}).then(t=>{console.log(t),updateTableView(e,t)}).catch(e=>{console.error(e)})}function updateTableView(e,t){let n=document.querySelector(".tableDB");"none"===n.style.display&&(n.style.display="block");let i=n.getElementsByTagName("tr");for(let a=i.length-1;a>0;a--)n.deleteRow(a);"utente"===e?updateUserView(n,t):"prodotto"===e?updateProductView(n,t):"variante"===e?updateVarianteView(n,t):"ordine"===e?updateOrdiniView(n,t):"dettaglioOrdine"===e?updateDettaglioOrdiniView(n,t):"gusto"===e?updateGustoView(n,t):"confezione"===e&&updateConfezioneView(n,t)}function updateConfezioneView(e,t){t.forEach(t=>{let n=e.insertRow();n.insertCell().innerText=t.idConfezione??"undefined";n.insertCell().innerText=t.pesoConfezione??"undefined";n.insertCell().innerHTML=`<button class="button" onclick="editTableRow('confezione', '${t.idConfezione}')">Modifica</button>
                                <button class="button" onclick="deleteTableRow('confezione', '${t.idConfezione}')">Elimina</button>`});let n=e.insertRow().insertCell();n.colSpan=8,n.className="center";let i=document.createElement("button");i.className="add-button",i.innerText="+",i.addEventListener("click",function(){addRow("confezione")}),n.appendChild(i)}function updateGustoView(e,t){t.forEach(t=>{let n=e.insertRow();n.insertCell().innerText=t.idGusto??"undefined";n.insertCell().innerText=t.nomeGusto??"undefined";n.insertCell().innerHTML=`<button class="button" onclick="editTableRow('gusto', '${t.idGusto}')">Modifica</button>
                                <button class="button" onclick="deleteTableRow('gusto', '${t.idGusto}')">Elimina</button>`});let n=e.insertRow().insertCell();n.colSpan=8,n.className="center";let i=document.createElement("button");i.className="add-button",i.innerText="+",i.addEventListener("click",function(){addRow("gusto")}),n.appendChild(i)}function updateDettaglioOrdiniView(e,t){t.forEach(t=>{let n=e.insertRow();n.insertCell().innerText=t.idOrdine??"undefined";n.insertCell().innerText=t.idProdotto??"undefined";n.insertCell().innerText=t.idVariante??"undefined";n.insertCell().innerText=t.quantity??"undefined";n.insertCell().innerText=t.prezzo??"undefined";n.insertCell().innerHTML=`<button class="button" onclick="editTableRow('dettaglioOrdine', '${t.idOrdine}, ${t.idProdotto}, ${t.idVariante}')">Modifica</button>
                                <button class="button" onclick="deleteTableRow('dettaglioOrdine', '${t.idOrdine}, ${t.idProdotto}, ${t.idVariante}')">Elimina</button>`});let n=e.insertRow().insertCell();n.colSpan=8,n.className="center";let i=document.createElement("button");i.className="add-button",i.innerText="+",i.addEventListener("click",function(){addRow("dettaglioOrdine")}),n.appendChild(i)}function updateOrdiniView(e,t){t.forEach(t=>{let n=e.insertRow();n.insertCell().innerText=t.idOrdine??"undefined";n.insertCell().innerText=t.emailUtente??"undefined";n.insertCell().innerText=t.stato??"undefined";n.insertCell().innerText=t.data??"undefined";n.insertCell().innerText=t.totale??"undefined";let i=n.insertCell();t.descrizione?i.innerText=`${t.descrizione}`:i.innerHTML='<a href="showTable?tableName=dettaglioOrdine">Dettaglio ordine</a>';n.insertCell().innerHTML=`<button class="button" onclick="editTableRow('ordine', '${t.idOrdine}')">Modifica</button>
                                <button class="button" onclick="deleteTableRow('ordine', '${t.idOrdine}')">Elimina</button>`});let n=e.insertRow().insertCell();n.colSpan=8,n.className="center";let i=document.createElement("button");i.className="add-button",i.innerText="+",i.addEventListener("click",function(){addRow("ordine")}),n.appendChild(i)}function updateVarianteView(e,t){t.forEach(t=>{let n=e.insertRow();n.insertCell().innerText=t.idVariante??"undefined";n.insertCell().innerText=t.idProdottoVariante??"undefined";n.insertCell().innerText=t.idGusto??"undefined";n.insertCell().innerText=t.idConfezione??"undefined";n.insertCell().innerText=t.prezzo??"undefined";n.insertCell().innerText=t.quantity??"undefined";n.insertCell().innerText=t.sconto??"undefined";n.insertCell().innerText=t.evidenza??"undefined";n.insertCell().innerHTML=`<button class="button" onclick="editTableRow('variante', '${t.idVariante}')">Modifica</button>
                                <button class="button" onclick="deleteTableRow('variante', '${t.idVariante}')">Elimina</button>`});let n=e.insertRow().insertCell();n.colSpan=8,n.className="center";let i=document.createElement("button");i.className="add-button",i.innerText="+",i.addEventListener("click",function(){addRow("variante")}),n.appendChild(i)}function updateProductView(e,t){t.forEach(t=>{let n=e.insertRow();n.insertCell().innerText=t.idProdotto??"undefined";n.insertCell().innerText=t.nome??"undefined";n.insertCell().innerText=t.categoria??"undefined";n.insertCell().innerText=t.immagine??"undefined";n.insertCell().innerText=t.calorie??"undefined";n.insertCell().innerText=t.carboidrati??"undefined";n.insertCell().innerText=t.proteine??"undefined";n.insertCell().innerText=t.grassi??"undefined";let i=n.insertCell();i.className="center",i.innerHTML=`
            <button class="button" onclick="editTableRow('prodotto', '${t.idProdotto}')">Modifica</button>
            <button class="button" onclick="deleteTableRow('prodotto', '${t.idProdotto}')">Elimina</button>
        `});let n=e.insertRow().insertCell();n.colSpan=8,n.className="center";let i=document.createElement("button");i.className="add-button",i.innerText="+",i.addEventListener("click",function(){addRow("prodotto")}),n.appendChild(i)}function updateUserView(e,t){t.forEach(t=>{let n=e.insertRow();n.insertCell().innerHTML=t.email||"undefined";n.insertCell().innerHTML=t.nome||"undefined";n.insertCell().innerHTML=t.cognome||"undefined";n.insertCell().innerHTML=t.codiceFiscale||"undefined";n.insertCell().innerHTML=t.dataDiNascita||"undefined";n.insertCell().innerHTML=t.indirizzo||"undefined";n.insertCell().innerHTML=t.telefono||"undefined";let i=n.insertCell();i.className="center",i.innerHTML=`
            <button class="button" onclick="editTableRow('utente', '${t.email}')">Modifica</button>
            <button class="button" onclick="deleteTableRow('utente', '${t.email}')">Elimina</button>
        `});let n=e.insertRow().insertCell();n.colSpan=8,n.className="center";let i=document.createElement("button");i.className="add-button",i.innerText="+",i.addEventListener("click",function(){addRow("utente")}),n.appendChild(i)}function addRow(e){let t=document.querySelector(".tableDB");"none"!==t.style.display&&(t.style.display="none");let n=document.createElement("div");n.className="divForm";let i=document.createElement("form");i.className="formUpdate",i.action="insertRow",i.method="POST",i.enctype="multipart/form-data";let a=document.createElement("button");a.innerText="Go Back",a.onclick=function(){window.location.href="showTable?tableName="+e},n.appendChild(a);let l=document.createElement("input");l.type="hidden",l.name="nameTable",l.value=e,i.appendChild(l);getFields(e).forEach(t=>{if(!t.label.includes("auto")){let n=document.createElement("label");n.htmlFor=t.id,n.innerText=t.label;let a;"textarea"!==t.type&&((a=document.createElement("input")).type=t.type,a.id=t.id,a.name=t.id,"ordine"===e&&"emailUtente"===t.id&&(a.required=!0),i.appendChild(n),i.appendChild(a))}});let o=document.createElement("button");o.type="submit",o.innerText="Aggiungi",i.appendChild(o),n.appendChild(i),document.body.append(n)}function getFields(e){return({utente:[{label:"Email (PK) - varchar(100)",type:"email",id:"email"},{label:"Password - varchar(63)",type:"password",id:"password"},{label:"Nome - varchar(40)",type:"text",id:"nome"},{label:"Cognome - varchar(40)",type:"text",id:"cognome"},{label:"Codice Fiscale - varchar(16)",type:"text",id:"codiceFiscale"},{label:"Data di Nascita - date",type:"date",id:"dataDiNascita"},{label:"Indirizzo - varchar(255)",type:"text",id:"indirizzo"},{label:"Numero di Cellulare - varchar(20)",type:"tel",id:"telefono"}],prodotto:[{label:"Id Prodotto (PK) - varchar(30)",type:"text",id:"idProdotto"},{label:"Nome - varchar(100)",type:"text",id:"nome"},{label:"Descrizione - varchar(3000)",type:"text",id:"descrizione"},{label:"Categoria - varchar(50)",type:"text",id:"categoria"},{label:"Immagine - varchar(2083)",type:"file",id:"immagine"},{label:"Calorie - int",type:"number",id:"calorie"},{label:"Carboidrati - int",type:"number",id:"carboidrati"},{label:"Proteine - int",type:"number",id:"proteine"},{label:"Grassi - int",type:"number",id:"grassi"}],variante:[{label:"Id Variante (PK) int auto-increment",type:"number",id:"idVariante"},{label:"Id Prodotto Variante (FK) - varchar(30)",type:"text",id:"idProdottoVariante"},{label:"Id Gusto (FK) - int",type:"number",id:"idGusto"},{label:"Id Confezione (FK) - int",type:"number",id:"idConfezione"},{label:"Prezzo (float)",type:"text",id:"prezzo"},{label:"Quantit\xe0 (int)",type:"number",id:"quantity"},{label:"Sconto (int)",type:"number",id:"sconto"},{label:"Evidenza (tinyint(1))",type:"number",id:"evidenza"}],ordine:[{label:"Id Ordine (PK) int auto-increment",type:"number",id:"idOrdine"},{label:"Email Utente (FK) - (varchar 100)",type:"text",id:"emailUtente"},{label:"Stato - (varchar 255)",type:"text",id:"stato"},{label:"Data - (date)",type:"date",id:"data"},{label:"Totale - (float)",type:"text",id:"totale"},{label:"Descrizione - (text)",type:"textarea",id:"descrizione"}],dettaglioOrdine:[{label:"Id Ordine (PK, FK), int",type:"number",id:"idOrdine"},{label:"Id prodotto (PK, FK), int",type:"text",id:"idProdotto"},{label:"Id Variante (PK, FK), int",type:"number",id:"idVariante"},{label:"Quantit\xe0, int",type:"number",id:"quantity"},],gusto:[{label:"Id Gusto (PK) int auto-increment",type:"number",id:"idGusto"},{label:"Nome gusto, varchar (50)",type:"text",id:"nomeGusto"}],confezione:[{label:"Id Confezione (PK) int auto-increment",type:"number",id:"idConfezione"},{label:"Peso confezione, int",type:"number",id:"pesoConfezione"}]})[e]||[]}