function optionsVarianti(e){let t=new URLSearchParams;t.append("action","showFirst"),t.append("idVariante",e),fetch("showOptions?"+t.toString()).then(e=>{if(!e.ok)throw Error(`Network error: ${e.status} - ${e.statusText}`);return e.text()}).then(e=>{updateDivOptions(e),document.querySelector(".centered-div").style.display="flex"}).catch(e=>{console.error(e)})}function updateDivOptions(e){let t;try{t=JSON.parse(e)}catch(n){console.error(n);return}let o=t[0],r=document.querySelector(".centered-div"),i=r.querySelector(".nome-div-options");i.innerText=`${o.nomeProdotto}`;let a=r.querySelector(".price-span");a.innerHTML="";let p=document.createElement("h3");if(p.className="current-price",p.innerText=`${(o.cheapestPrice*(1-o.cheapestDiscount/100)).toFixed(2)}€`,a.appendChild(p),o.cheapestDiscount>0){let c=document.createElement("span");c.className="original-price",c.innerText=`${o.cheapestPrice}€`,a.appendChild(c)}let l=r.querySelector(".flavour-select");l.innerHTML="";let s=document.createElement("option");s.selected=!0,s.innerText=o.cheapestFlavour,l.append(s);let d=r.querySelector(".weight-select");d.innerHTML="";let u=document.createElement("option");u.selected=!0,u.innerText=o.cheapestWeight,d.append(u);for(let h=1;h<t.length;h++){let m=t[h];if(void 0!==m.cheapestWeightOptions){let f=document.createElement("option");f.innerText=m.cheapestWeightOptions,d.append(f)}if(void 0!==m.gusto){let y=document.createElement("option");y.innerText=m.gusto,l.append(y)}}l.onchange=function(){updateOptions(o.idProdotto,this.value).then(()=>{let e=d.value;updatePrice(o.idProdotto,this.value,e)}).catch(e=>{console.error(e)})},d.onchange=function(){let e=l.value;updatePrice(o.idProdotto,e,this.value)};let g=r.querySelector(".quantity-select");r.querySelector(".add-to-cart-button").onclick=function(){addCartVariant(o.idProdotto,g.value,l.value,d.value)};let v=r.querySelector(".formInfoProduct");if(v)v.querySelector("input[name='primaryKey']").value=o.idProdotto;else{(v=document.createElement("form")).className="formInfoProduct",v.method="POST",v.action="ProductInfo";let P=document.createElement("input");P.type="hidden",P.name="primaryKey",P.value=`${o.idProdotto}`,v.append(P);let x=document.createElement("button");x.type="submit",x.innerText="Visualizza il prodotto completo",x.className="product-info-name-redirect",v.append(x),r.append(v)}let T=r.querySelector(".close-button");if(!T){(T=document.createElement("span")).className="close-button";let w=document.createElement("img");w.src="Immagini/close.png",w.alt="close",w.style.width="50px",w.style.cursor="pointer",T.append(w),w.onclick=function(){r.style.display="none"},r.appendChild(T)}console.log(o.idProdotto)}function updatePrice(e,t,n){console.log(e),console.log(t),console.log(n);let o=new URLSearchParams;o.append("idProdotto",e),o.append("flavour",t),o.append("weight",n),o.append("action","updatePrice"),fetch("showOptions?"+o.toString()).then(e=>{if(!e.ok)throw Error(`Network Error: ${e.status} - ${e.statusText}`);return e.text()}).then(e=>{updatePriceView(e)}).catch(e=>{console.error(e)})}function updatePriceView(e){let t=JSON.parse(e),n=document.querySelector(".centered-div"),o=n.querySelector(".price-span");o.innerHTML="";let r=document.createElement("h3");if(r.className="current-price",r.innerText=`${(t.prezzo*(1-t.sconto/100)).toFixed(2)}€`,o.appendChild(r),t.sconto>0){let i=document.createElement("span");i.className="original-price",i.innerText=`${t.prezzo}€`,o.appendChild(i)}}function updateOptions(e,t){let n=new URLSearchParams;return n.append("action","updateOptions"),n.append("flavour",t),n.append("idProdotto",e),fetch("showOptions?"+n.toString()).then(e=>{if(!e.ok)throw Error(`Network error: ${e.status} - ${e.statusText}`);return e.text()}).then(e=>{updateWeightOptions(e)})}function updateWeightOptions(e){let t=JSON.parse(e),n=document.querySelector(".centered-div").querySelector(".weight-select");n.innerHTML="",t.forEach(e=>{let t=document.createElement("option");t.innerText=`${e.peso}`,n.appendChild(t)})}