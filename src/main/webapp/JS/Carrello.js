function updateQuantity(e,t,n,r){let a=new URLSearchParams;a.append("action","quantityVariant"),a.append("quantity",e),a.append("id",t),a.append("gusto",n),a.append("pesoConfezione",r),fetch("cartServlet?"+a.toString()).then(e=>{if(!e.ok)throw Error(`Network Error: ${e.status} - ${e.statusText}`);return e.text()}).then(e=>{showCartCheckOut(),showCart()}).catch(e=>{console.error(e)})}function showCartCheckOut(){let e=new URLSearchParams;e.append("action","show"),fetch("cartServlet?"+e.toString()).then(e=>{if(!e.ok)throw Error(`Network error: ${e.status} - ${e.statusText}`);return e.text()}).then(e=>{updateCartJSP(e)}).catch(e=>{console.error(e)})}function updateCartJSP(e){try{e||(e="[]");let t=JSON.parse(e),n=document.getElementById("checkOutItem"),r=document.querySelector("#subtotal span"),a=document.querySelector("#totalOrder span");if(n.innerHTML="",0===t.length){n.innerText="Carrello vuoto",r.innerText="$0",a.innerText="$0";return}t.forEach((e,r)=>{if(r===t.length-1)return;let a=document.createElement("div");a.className="product";let l=document.createElement("img");l.src=e.imgSrc,l.alt=e.nomeProdotto;let i=document.createElement("div");i.className="product-info";let o=document.createElement("h3");o.innerText=e.nomeProdotto;let d=document.createElement("p");d.innerText=`${e.flavour}`;let c=document.createElement("p");c.innerText=`${e.weight} grammi`;let p=document.createElement("p");p.innerText=`${e.prezzo}€`,i.appendChild(o),i.appendChild(d),i.appendChild(c),i.appendChild(p);let s=document.createElement("div");s.className="quantity-div";let u=document.createElement("input");u.type="number",u.value=e.quantity;let m=document.createElement("button");m.innerText="Modifica",m.onclick=function(){""!==u.value&&updateQuantity(u.value,e.idProdotto,e.flavour,e.weight)},s.appendChild(u),s.appendChild(m);let h=document.createElement("div");h.className="rmv-div";let g=document.createElement("button");g.className="rmvButton",g.innerText="Rimuovi Elemento",g.style.backgroundColor="orangered",g.onclick=function(){removeItemVariant(e.idProdotto,e.flavour,e.weight)},h.appendChild(g),a.appendChild(l),a.appendChild(i),a.appendChild(s),a.appendChild(h),n.appendChild(a)});let l=t[t.length-1];r.innerText=`${l.totalPrice}€`,a.innerText=`${l.totalPrice}€`}catch(i){console.error("Error parsing JSON response:",i),console.log("Response text:",e)}}document.addEventListener("DOMContentLoaded",function(){document.getElementById("buyCart").addEventListener("click",function(){if(!1===Logged){let e=document.querySelector(".error-message-container");e&&e.remove();let t=document.createElement("div");t.className="error-message-container";let n=document.createElement("p");n.className="error-message",n.innerText="Per poter confermare l'ordine bisogna essere loggati al sito!",n.style.color="red";let r=document.createElement("a");r.href="Login.jsp",r.className="login-link",r.innerText="Effettua il Login";let a=document.createElement("br"),l=document.createElement("a");l.href="Registrazione.jsp",l.className="register-link",l.innerText="Registrati",t.appendChild(n),t.appendChild(r),t.appendChild(a),t.appendChild(l);let i=document.querySelector(".summary");i.appendChild(t)}else{let o=document.createElement("form");o.action="orderServlet",o.method="POST",document.body.appendChild(o),o.submit()}})});